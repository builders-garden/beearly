generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  address       String
  created_at    DateTime? @db.Date
  updated_at    DateTime? @db.Date
}

model Waitlist {
  id              Int              @default(autoincrement()) @unique
  name            String           @db.VarChar
  slug            String            @unique
  externalUrl     String            @map("external_url")  
  endDate         DateTime          @db.Date @map("end_date")
  imageLanding    String            @map("image_landing")
  imageSuccess    String            @map("image_success")
  imageNotEligible String          @map("image_not_eligible")
  imageError      String            @map("image_error")
  userAddress     String            @map("user_address")
  createdAt       DateTime          @db.Date @map("created_at")
  updatedAt       DateTime          @db.Date @map("updated_at")
  waitlistedUsers WaitlistedUser[]
  waitlistRequirements WaitlistRequirement[]
}

model WaitlistedUser {
  id            Int        @default(autoincrement()) @unique
  waitlistId    Int        @map("waitlist_id")
  fid           Int?
  address       String
  displayName   String     @db.VarChar @map("display_name")
  username      String     @db.VarChar
  avatarUrl     String?    @map("avatar_url")
  powerBadge    Boolean?   @default(false) @map("power_badge")
  waitlistedAt  DateTime   @db.Date
  createdAt     DateTime   @db.Date @map("created_at")
  updatedAt     DateTime   @db.Date @map("updated_at")
  waitlist      Waitlist  @relation(fields: [waitlistId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([waitlistId, fid], name: "waitlistId_fid")
}

enum WaitlistRequirementType {
  CHANNEL_FOLLOW
  POWER_BADGE
}
model WaitlistRequirement {
  id            Int        @default(autoincrement()) @unique
  waitlistId    Int        @map("waitlist_id")
  value         String 
  type   WaitlistRequirementType     
  createdAt     DateTime   @db.Date @map("created_at")
  updatedAt     DateTime   @db.Date @map("updated_at")
  waitlist      Waitlist  @relation(fields: [waitlistId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}